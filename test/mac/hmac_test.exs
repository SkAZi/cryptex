defmodule Cryptex.Mac.HmacTest do

  use ExUnit.Case
  alias Cryptex.Hasher
  alias Cryptex.Mac.Hmac

  @golden_nist_test_vectors [
    {:sha256, "0BB4127D89D9073EA425C303ADC3F9DB39E40ADAC23EA61FBA8B6E251D79390F", "C18BC28D496BEEDB25CA42D1B217BC81891D4C2BBB35380E5BB9BF7E3DBBFD37FEF70EF14407763447D6C06E915766430277F124165061236B9FCF057D785199B4381E49A2BCF3EF85D0", "28B18B862CE9541ED6DAF81199F9A331133B0EA3E48FF486C1ACC6D5C40E9F8F063B7A15704BA3D3CEA76B222511206D47E53C93A49EDD8D639B7551B224C3F65AA802189648607E259AB1FA9EA665910435B7DC9A4C28AEF8F32CF85F3A23E94A7E8A5945E9736702383261AAC15AE571B4E8466DA1BD31A83A5291745BA7AF"},
    {:sha256, "1CBD4F923D683CA38ACA6CD0AD81151062FD642B155B2A950EB551CA8216B0CA", "76D8E0342011D2BCA953B26EE200E56685B721D50ED4DDA7CD3A05633A50F153884998E67DA901528004FB7DF4090E1EC4C0B11F3F10BD4727842215044FD9EF", "0EBAEFD2153DE2C70537CEB27E5EE70105AE85BD4DA38462B4ABEBED11DBCD36ADE16D808F3AA54FFDA5897A3FD74780A670521FCD2EBF231F60EF7D999E6E94D1B81BE038EC89B49C5CA65BF1BF9A675056F2464021FE16355477BA5605652E8327401797BB569FEA456C7F1B7DA85D0C48AF592DE60AE3FE6DCECFCF767CAB"},
    {:sha256, "26DB47A48A10B9B0B697B793F5C0231AA35FE192C9D063D7B03A55E3C302850A", "62E3A735EDCD87FCA0DD1D2797CC0E574160DA9AC23F60E39501A5B77688D1287F947A0791922556F5B50AFC434818BC83433968931CD752C9DF9F04D8818531", "EC638734D336B8DA6DFAF3DA9E18C7131494FCC0709CD3A9A6618E9BA62533153C958E44345A7531C3EB503A22A5D8BF7C1D1E1D0AB5CFE07D6DB7349CFC859D2E20CEE81A325462CDFD8747DCD04C7DEAD2FE82CD96B2A4ECEFC070EB067F6C8BA94F09CBE6DDD354D9A2EB13C2ADB7285AA3D8FF68045CBC8FAF35DD6AA9EA"},
    {:sha256, "2C723282159CEABC5B367B95CD807F249F1DFF7F9EBF5BA179A43081454E1B05", "08CCE7D7F3CCEA0212CF0299F27F3D3F393A97D3DD71CAF1954E67BC8D9A26DB5EDD7AC23DC7693372CE9B040D", "33AB861F089BAC0E5C886F66ADC568AE7BA331655A371DE7475E269138FF2725F7904C702FDCC62AC703C31D70C29D8A7AF451C8EC59342ED397E133DA7E76D41B90003635C1338D9F7B5F3C3CE59F3E2F6554C4F064D11F9F5158E199E8463F4AB48ABA42D25BFF8AF92B0B38B7D69241FD20A28FDE5E84539473E39DC4FE2F"},
    {:sha256, "2D3A760595F3FB19293CC6D23651222A9F5A4F02284457A9C1ED4C43AC993CA5", "CEAB398E4107483EDE64CE107C9270E6022778B61F6A258D3B7045D4AD8506D32ECE0A738D2CB948A562DBCE8D7B66F30E6694D65AE439CFFAA454AF09ABE449", "6DDE9AE867E2FEB367008A975D7853ED8F89690F3C87A1107F2E98AA7736F477A527ED64956F0D64C1B23361B261DE78688EA865FCFF113C84817E5B377E829CD2D25BCF3ADBC06762CFDA736F5390D01A49079D56E969F03313E6C703E3F942BB87ED0F9C4D9F25120085B5DC75EF5D6D618DA0926D3293568DD7D8238DE3D0"},
    {:sha256, "2F8321F416B9BB249F113B13FC12D70E1668DC332839C10DAA5717896CB70DDF", "992868504D2564C4FB47BCBD4AE482D8FB0E8E56D7B81864E61986A0E25682DAEB5B50177C095EDC9E971DA95C3210C376E723365AC33D1B4F391817F4C35124", "ED4F269A8851EB3154771516B27228155200778049B2DC1963F3AC32BA46EA1387CFBB9C39151A2CC406CDC13C3C9860A27EB0B7FE8A7201AD11552AFD041E33F70E53D97C62F17194B66117028FA9071CC0E04BD92DE4972CD54F719010A694E414D4977ABED7CA6B90BA612DF6C3D467CDED85032598A48546804F9CF2ECFE"},
    {:sha256, "37F9F32918308210849DFEBF8DD456804BABD6845AF07218F9D9BE9DF9743D55", "BCE50CDFFF843885D4F364D69F93BF58A2322C707B82E878EEC96D11E5DB97BBB54606A3A3CCC3BBA716261070A6F759A70ED3CB785FD1354FE56648DF11863669B70C803B7A", "93B7EF0E470DDFAC6AEF93C0DCD37B8F1C4BAF5EADD978E3BF0512FA0BAEB099FF9EC1061B6172479B5674DB5606FFA7E6B5173309370E1647054AAFD5904816BAD5E1523032CCCD4D786505E241AC83A484911189666F287553D6A8164E8DCB0C85D75C4E29F624C97CEEA64A2C8B0C9DDFA560F70FA3FF91183E4B968F88A1"},
    {:sha256, "4A34BD4DFEEF7FA1DC739280F16A3FE1281A51311C10A920AB43D406D4AE3370", "9319838432CA096960E2196A06398134EA06E4E8799BA470C54F0512CABB9045F529B6C4E749B6E27626C11DF4595BF5B47C04FFCBE218351485F49077405AD96A3F17BCB7B3E21E80CA", "57E1D3FF5FC4785F9370DF2E5ABF454579752EA934D2A9BAB568D5AEB22BA43E4BC7DF9F31366BB40D91CA822026E4E426CC088081732EF993FF7F676C571704A5B809278B50A3778108F4589FA18CAA9F0283B3FAD0BD594E406B950329D5242E5E5880B53AAA0EB57C66992055C4FFABC0A72AE712DE42ADD2A321C0CA6808"},
    {:sha256, "4F2501D2A88CB13046A6549F90E4EA924773408BB684025B5126A8FC21F48670", "731EC9F365F28F1CB9C4EBCF89D8648732A6DFA958D2C0152B5E52FAE81F69EEA26D463E421FBA82CDB78F75E5D92304930256A54376A6EA107A995642C45C6F", "D98557504A21FC3A434C780C328EC239CF8D7C26F58D6AD7B23329C79A8E1E176058ACEBA778AA1215CC14E5A92600714F94D4D8B2E5B7F45268453ED6F787EEA3342264AD13CEC78D990AECD5E30F79A069024A6D846D132D2EF0479A093439CBA4218205F951A2D53AC4EA5BCDD599E9956C45CD73767C6A0C92AC8ECD0D40"},
    {:sha256, "514BD18495F6DE0E237054B8E3BA1A74C3FADA4279AD6B8550F3A14712C528DF", "81574323C973540719D192833DDB51F13A52DCBAE294AEBEA51BE5F6AA47F3571F5D97FACDCF0C7BEFBE809F44BDC73963D8514E4FD559774BB96087EF8EDA6E7C64275D6D96C42B4E4E", "B9E944E0B42D0FF454F7F8AA24F00E9EE039058CE4094111E39731B6DC3ADE2A4ACEC4CF9C5BE078E4F10A72D3D685C1E5E4D5ABD92CD07B64DFF87F266F0853DDF1CD61D9C637A9B07AB0BE32ECAC119FAF827218B17AD4541A27519477F76ED918089F54B63D0E1E5A92982979AC187764B5E989E066A61B1065340E9CD203"},
    {:sha256, "5717FC337916D66B4E292E69D507B1C81663D8140536670F3E70E33B04C83AC3", "E3D0C3ABDEF069E6E4FA35015797BD8A9D64BC9B75F20B028B12CCA04A4FE80FF1BBBD88E9EF1003564D499FEC88DF4503671188EEC5D7D089DD18B812C41DB43A3746F77B97", "934DC1EF76993AA82061CF67AAAC7714F12E25AA8F6F54840A2AE3D84AF32481511D300126DB7DC612A5B2AC0FDEB9C47EB316541846781E270C8EE5F6731C2E86C94E4482594C7E75D70EC43BFE7250B6778CB2C2FD3D176ABF07CA5C051FFB9A17C4C0735BD059B2BD8DB81553C94100412DCE73DBCAF63A0AF58F63F15571"},
    {:sha256, "6C63BED6C6082BFB085CF2426EF3D0DEA97ACD717A57FF0AA624D0B803F2EA14", "85806FF2A642F729D28DED0734AEF4F6A3F0BB32771E77729B4391CAE4B49BD0A15089FE74071E576099A44D22A0E0E3C5D1450F717F68628460B4EAE3945F5893E39C5E8347", "DF073817D8687293257D7ED1816803AFE292D779F34E14B0C5BA6E0AC1E6C3B9E239F4F02110F4A430A71E906A3DCC7B0B7325BD9CF63600B25D4544D8556126CAFB3E61E4894095D935D647A8560929CCC9559CB393B77472C707FBB7AB8838FF16BE71091C7FEE8AED4D0022FBE3428F5B0E1F216EBE946DC05D3746305F79"},
    {:sha256, "8E44D685FA79395B4761CAB89688E37509E69AD007A2794C8C0B4152B67036EA", "D8B994BB8DF02D7803CA2E09D601B918D6B5BDE90B611BEBF70E078D1AC7B152BC4C2528E60B70F6", "B31D11CB4F5C572CCF3405C65CBD218EE8ABDC08B6C82E5D1DA2BAAF8980F7A9C29B915A718B0D43E000ADAE01B29342B29B28D53F63BF81281C76FA252F5D1E6896DBCE224C4DFD4802EF0697140043D6BB21DB5B84FFDBD001318937BE64F52C76B5D06A875E8191A4957627CAB1B8DC758FC3121334949CB9B303C6155153"},
    {:sha256, "9611E838FB1D816A0FF9CD269217D93258C34DF9E26B74476FE4DA0F7DEE2335", "8FA12BC017BFEB6C894020E420C5F76F9080E8733B998EF3A7D0B6563063B66AFA3200A82A21F6BA56BE003A3924DCBDAC1F3610D29079C19213E4E14AE0E009C1EF919B5E60AB4A9819", "FAA6CE40D931F3C0CB4538A82A22F0D4F3221F027B99D3D85DFFB729B751E57496B4FCADAE5C72404FAC2C54949E4C4CDE664B948052479ABCF59E1AEF84BB9F088030473E9505C603C350AD33BB06ED928C1196757EA3E5BF3EC97E0F3C43F638529394F2A65459CFD1CD3D7041C6BCF8DB9A91C1E58EC24E2461DC81412580"},
    {:sha256, "974752B18D0DCBF29CC6104295E041259622CB7733CFF63DBCF6808B15A5AD45", "19FB88775A517BFEDEB2CDE7C9455CA58D40D150B0A47FFBD0288E42E4725822C48D130EEC98B13E7CBB044B846026F97F9F18531DF9A9FE464A99C75BF9FF7EBF72E80796D6", "892525A0F02AAE7F2264CB024632F11E8ADBDBECB7D0C7080832E2373C94014CEA02914C1542D1D000593FAB43524FCD1F3A63670F6FF8509F1B1DA881FB2ABBDE65AE27EA89A942BBF7FCB65B611D6E1CA20FB62B00929D68AE979E7595F6800D55637B98869F9CFC43EB6BB5E9C2CA281CC720340BFDB70BF5366340EDCE65"},
    {:sha256, "A51F5988A8F0F3992F549EA7F8C370A06D5AE8D65880067997536385D632B206", "30BE326C2FFFF6D031AFFDAB0A27D5A8CBFC4BA9DEC626AD522615F77307E56D9E23F73E53C9F2C78CDEB5B84D2390727DB5B3B4F4DAE677D5FA7B161EEC81B27D743BD56609", "082E7B4CDE8914BF07C288441BE643E408F6CB5CA932F67E9B975BD54CA706885468708009AFAECD4D9EE846AB6C0D70A364C5A24131A766F558AD219E06E4F7E80C68E9D8289040A586662FCA865AB459C037BF92465596B4281178133E7A806B214DCD747B24E0B681EA459FBD9276D31108FCC3F968D781106F20D3D62FED"},
    {:sha256, "A5772A3DA86365B46638F1E97037FC0D8351D2E19ED929F85448EBF4E8379A8E", "CA5F3EB9308604F9FCC2AF1C6A3175CD8A75045593B473BD7AE37933C345DDB0982E2DD7180DB31F", "8734E49E3E629DEB352C77F58FF4DCCE2AF3B1182E7D896AE68619F6CF66ED69EFD95913684AB1484D51BC06B47A67D70D48B7F9B27901BDBF8C5D2D238158F1F7E0E9740FFCA742CF7938B5400C0DD063824C6BC6040E905499CB2671EC12CC47507E085A01E5A163ACD2495B32367FD6AA5AB492A518AD50B54B28E23084C2"},
    {:sha256, "A9C9D3993FE7EC4C2033CCF3B73B3407CD999D67455B43A75D6BA97EFDA3BE63", "B06F7CA7A5DD8BAF2CA940811EDAD87A33DA666DC427BCF4D54A8E03520DD5C399E9729D39BE1494", "32B45FBCBAF262BBE347360BD6076C43DC26BA9573FCABAEA14595DE886CCC793B09157DD0A85D74B6CCAB9C49335446A45C6E7CB64786E6997C96EF1E4E3123AD6101DB4C6A731DFD36B1BE4DEED1C92A994B25F5E2B171D81B9A335A83E03230C40B2056C00C7C5F8D2FB70ABE4B9615E53BD756569217072D8BF362923F6E"},
    {:sha256, "B53DB6BF0C8317586AE6C1A1E2857F241BF55DDDD1B423578C6949D4BF014611", "C96C04A3BB0816FC47E05913A715FBAC9A3AD09DB75B48E8013D9F27BBE8532D7E63DBEA88BF968F575602F377552E35987872A4E3155DDB8E5CEF30AEDD08504D4B2123BD7F3AF62BBF", "B11389C7DC20FFD0C4A5F887F2576BDC302C7D2AF7089A012799C528FA7F2CE23BB10071B31C83D9E58D63E6FBD04670FF1AA6DE4EA4DFE94A9986A35032FDB7EA1F44F2452A1202E517257E97CED627A7BCF06E5476C236819F73DAAD0D96722527FE527891D4D42C0CE658AF97428890DA04E1EFC56C6F337534D7FB57209B"},
    {:sha256, "C02C6022EE0DE099E3027850BE95A29CE800118ED3A97757DD8AB9E60F69A005", "98FFF7B5F77326C24471BB9C317490BE1FEBAD28E2E825AFC41C3B97CC03C963405CE3EC68DCB7B19523B76E62", "64A78A4D6FB8FF3813DF8DC022FAAF4415E4DF2949E16467683C6C47242E5A6B2C02610E5877528D2766B2266CA41000442A956C4B73DD6B10260570C6F506673CC541F50F0F5B021E864A753EFAB03E2F7C689ACFC35F928ECEA6C522CBC5687C38518BFA48C19EDE887D33FFC23806BE21803A3C9793E5CA7C75CFA1783F77"},
    {:sha256, "CA0053D51F6CF6F9998FF1E0DB00B90E82C7B18CB5377ACC8EBE9AFE20DA1C3D", "44F71C2317CDE52151C84260D1D3C04A28CC15CE5B3802B2E5357E2BFCAF10AB15D77DFAAAD1A3883BADA502939948234C559DCD95E7E158338FA12AC6FD21874EC2FFABED051416EF77", "2AC0BB0524C22B902DE34CE64E6172D1B2074E159F517AB1ABD152622CD10669F03AED8E2EB51C65BD0F38D084E288C532724E512FD558DDD257D2B1D41C5EB6040767803DDBB18B95A035C5D8492D4D35936B7B3630EE20F625B70F8E71D9DCD0EFD0E3387D138C1F5EEDCE32DD88F223334B9A9EAB65017F04AA8442179F62"},
    {:sha256, "D08563DAD7C32C02B305B87FAD504918FD566C433E98A1367A3DBBADB26E9B64", "F13794E5EA5E27507A7BAD638F8EB8B86CA5AD73B5A17424C63C74EF494BBFEA084189C6FFF5DFB2B6A5967CCE3A81F9D9CDE7A86F6B33927E15EE74E10BEB20344BC121E754", "CD3F17355A1E254B9821276141A850F0B71CB3CF4824A803B01C71D8DFC31D31FD33AD1CAC1776A98D18C6FD0598CAA241A3AF21772208D36F5270F4437570F963C8A323DBB41755D948F72369E7672B843EB0A849799D448AB7252E8ABB496D05E44074715FD2F6849B02FBF6FDEF3488D6FC8B45922FFF0832D7AF3EFC7234"},
    {:sha256, "F15A210FCA2CEFC4D92BF14FF572D021463BCC28F60D034E87222DC6076EAFFE", "731BDC9FB219F3667C9A135ECF34C7F52CF638C39C554F1EF1691AE84E5A71ACE915D9E91043A8AE6A7B6A6780B684F77B0417072F7E279D597CFDF02508C97BF4928C505BE5", "12353BCA6B0F3D545EC4B470C69272F72BB5589793E6CA769A226018C5ACDE83145567A1D6FBEDE5C150EC3142DC58F81246D4A00ACF242A381FE51432447B7EAAF84C8D43222C0DA3A0175ACA442680A21CBCA1D7F70097E82491DB7F7D75A5FEA552555A8DE0122C3D9EB105D1C4D802C17963A1664706D3BACC345360B240"},
    {:sha512, "0D73F53C10C029069A2D1D5733BC6BE8A1E94DE821573DAA290FBEE3F897F44297CFBD515CC5DDB0DF7BF44EF58C446EC085C32C8D6EF779A5518E63328DE957", "484BABC2861503D442448C3C43D7569A380EADD9EED2EEB4C651997867E9A80BB0471F2DF0D0E5FE5A3FD2C0B39009DF4E1E882E3A08FD74BAD8DB27F567AE77EFFBAC8FB8B38C17E4259BFD3A450C75B1898F3E984A2627146E34D3CF44D7B9EFAF786E4587A127C73C0E7A41BC06644797EC906E6111D6BC59CC035C", "B04BB381F91B8B64478391D6AB6AE306E796020418BF917899E85A9423EF924739625EB4C39496E2F9F0C8B5828E801DDD04C68D017FE9AF40127B56714D9DB44E127DCD1BA41C2B890155D3D9721B79446002F09B6900E42BB375CBE3806A19B90316B34973A7A7BF5D3F1AF83E3C82E451BC152FA66080207451DDC1B081DF"},
    {:sha512, "1BC503398A25223FB9E93EA65228D2727B201F0A3FB544A300DC804340B6AB3676862B6320BCE35ADABEF387EC628DA38277F7DE6929C44810C47F2A7ACBEB03", "107ED9CA1F16FBDCBDFA5211B1A9EC8D9E03BBCB1F0A468715E99FDB403695A80D742A37AFDC4820715DAF6B4BE132F6B3D22316B5DC0C8146F59F6CD69BF0F0245DE2B2569DDFC34994CDC526973D503698E594F7EF503F6F5BD4A1C043C50DFD42E8833CE32A8DECA9926769537562CE5DE98A0BCA7B87372125C127B67AC83F2A24F28835904603A3E8", "204058177A61AA45BD666BD0F3870645FD6B9330CB91A89AD3F072CFBBDA04655926EE79DE8E123C4E56B3AF342FCFAA935AAF231F10BCADAD22943FE9DD5D3747305A9E3C11BBAEAD1CBA91A87DE36C5211B39C20C865404A4E09F77DEAD6EBD1A6C10EFAB04FA3C200A701B73BEB9320D7C82436814C5991BBF87FE1CA1787"},
    {:sha512, "24D2DD3D082E6556DBE27381640837A23E5D4A4D6822066CD09217A677068E5B8901C1ECA7DA77A9595BE271ABFA76F9D40656CFBAE050FF6D8DDEDB0F4C82ED", "345479AE901ADBAC7223F5F9EDC419BB64665CBA4E3684B7371E28FF07F3124087F0E89A21630CF9E8A6C0A3D8518E0D5EAEE7F31B6D0AA7E59927AA0ECBC479E99E61A98B625736CF1506199D8F2F186BFC9FE2038F0E5B87754635B30888C063462B035581860B2F571083C4E5C6859338CDB09004597B2899CDC87F1224BDFCD08FCF07275F1F1156260AD5BD", "E4B38E556AA285688979A55EEACD7D953F1EE0AB8109444C7CC068488EB83AE9ACA1F783A59B944CABA75D6E0F5BDC5B4CDBFC6147046E7ED5EA4C757E85FC2181A7580A17310B36FC873E422C4175B1EA24B3830750E50961BA7DF9AADD5EBE6BADF81148CDB4CD850192FFC9E6103D22E14F3A4A557197291945FB9A292665"},
    {:sha512, "2C537D0EDFA86126672CA6F0081E8C13FD161510D56C0BB6EF015EC35CDCBADF4FE68594FE70820EBFD99CFB83A1FD18FEBFDE2743BF408479A52C3334E39141", "CF44B9D057CC04899FDC5A32E48C043FD99862E3F761DC3115351C8138D07A15AC23B8FC5454F0373E05CA1B7AD9F2F62D34CAF5E1435C451F3D927940E8A92C805EE3E754117C45FE0DE0545E7D1B3F0B71912AA2DEEF5E5EE661A6E95A06F8727EA158000C91FA067B03A7378066619BD61F4AE33B7EC2FABBF1D0DC3078C3AB0A5919004C159F7FD79A", "FF24C8943C8E6D3DB40C7AC16776F756C44803EE07A3C95BC594AFB7C599D0031261AD0E4ED41F98495391B8D3416B7BCEC2D1CE87C28E9E463A4B3D23AE05081CFBBE47654F7254FF794C008C631A3262DCFFD1DE9B67E4FA8140F8221F68C24478610627084CB8FD0515603BE4EBC3A81FF3BFB4363D770CF4F7B06BF3E07B"},
    {:sha512, "3780EF695742F09A160C8DD7D35E2758B08284E8150934D222DB31DF2767D40D7C815C526ECEE5F787030C8DC5F050C419EC6EA7563650DCCE1480892D3088E6", "8A0349D4D1ED8C4AF533E9E83468B5859BB68237798038171346684499C9DC2B5970730533EB2CA04D1680630820F58D32ECF0BD7DB7CAB72FFC27651C94831CD1220E2113AEBA6C889092ABB3904D8A264B2332F2D9DF0F63AC36D7EABB57C85BE0C331587F5F330D69C7C91F00E606DE9BC49EC22C9EA815203CA2ED867FB65D743A3BECA6427F4669C9C432B7", "035F55033DF01F670015A828EFF154A245E8CA7474B0B3330CABBE5FDD74E89560B8FA075347532AA46AE7AE907888B30CA4653A6419D0D9224944B43181A6A842C1CBC96FCC3B0F1E7B344C2956F2613C652EB27E44E5D773765A9521FB5E0C7125CF31D9A75F7F38EF96EA01B61B159CD52FC4095A7A94C7DB0AEAF40A9929"},
    {:sha512, "38CA18D60F180FD2A40E342272190D9B84BA37BBCCF59B29BCBDB08762A90E1F8B28349CA634A6F955CC08C96835EE70A2267444FDE88B45B8E313B0DAF6E12F", "29F8EB9FC8AB58FEF681F9FAAF934E992D42046F0CCD2FC9AB23D42BD5F5AAFDA110218196EAA408137A1B66EE4DB5A35CD7E4F31107A9E8A81E11E744C000D9784B2D2264696ED721E1362B60B35B2B4D631DACBA95658179DA4AF109CAD9687653166C7A503ED3E85D4F334AEACA9BC98FB8804E9FEBFAE70086316C3AC01162CDE4461FC89C642F977065F71D", "3AC2FFBC5B6B2334809232C0F8151ED379A8634D70D3F5A1963A7637C421AD0F082F34A8F872702046A4C69C95AD0CEA8B683E6528AA731956810F28C1B9396DE8A5905E751C1937C9C17C55DC8771DF447575AC93A7C161E6967CDABB9930CC03AB7BA8796E07C23170BBB274AD33FACB566EEA5AD1C7C16F0127155BC77875"},
    {:sha512, "39D94C4E1C8456BED8637E592E4231854DF3A6FFCE98463E4A85C477D9FD34D27035CDFCCFCFD385D91E4E38E8C75D9FF941DE80742E985BAA9C94DBEC5A6837", "EF71B7B3CA0F904DC50447AE548096B2B3603B312A5E59D490851B270EE99AEF259401BDF2C3EFC3B1531CE78176401666AA30DB94EC4A30EB281494BEF5205DD87F3350C1C4A56F3D040B12167214391B30B121697A7915E9224B871A3C355F111A9493BE7B7DF870FF5C589BDEDBC4DADA062B3072AC2C93590829AB26A09DD74D6EAF714E3E07532C57E09921", "50EC304FA342839457D7EB28791B671BA5C425F711C3A351CC76149D481F0547179540FFF239F054FF2C078454BFDD92B72B199AA783D562A1E6FD319CF9F8E4D6948B3ED2BCFA80A1D270396209A060051EADA0544347F3335C1872266D5E6C1553D9B54CB3E740C631EEF0ABE2FAAC1703A7B21DEB422D0C3E2B09F0647D06"},
    {:sha512, "41A4C83777750D4FEA58645CEA32FF4456C44953B466A5980D2B8DA234603547A6259188F8693649DCEF85E85110026C006AB968297567CE823965A1DF6701FE", "21251DDBA377E48FA35AD148389C486A84E623F3DC49F9AF281AA0AF8D00F0F74A4BCA77E087593D765198E87B6A15608D0AF4C49A7736A445D53C718B408631A618C177319C01938EBB4B06852656392DAA926E10BD6AF68A57C6A47203D583FC3509C4DEDE63FAB23EF08A9CF9945C2C6E06D786441C0DC04549328B706453", "41DA7852D48D59FC2AD0FFFB9D64B9AE213F3266D5D4A2C7D89445725EB50DE1033294915F135467DAEE1A4DC1AEB81C9A93FABEB57ADC94045FFA152C2048B8DC8303145E7BE8466CA7A394441C8A50FF648BFE1EC663B966C811D2EEF38BBB76D6AF23FA4E7C63870482194E369712F7BBCC6E3741A0FEA5DA73F1C9B73DB0"},
    {:sha512, "4459066109CB11E6870FA9C6BFD251ADFA304C0A2928CA915049704972EDC560CC7C0BC38249E9101AAE2F7D4DA62EAFF83FB07134EFC277DE72B9E4AB360425", "C367AEB5C02B727883FFE2A4CEEBF911B01454BEB328FB5D57FC7F11BF744576ABA421E2A63426EA8109BD28FF21F53CD2BF1A11C6C989623D6EC27CDB0BBF458250857D819FF84408B4F3DCE08B98B1587EE59683AF8852A0A5F55BDA3AB5E132B4010E", "1A7331C8FF1B748E3CEE96952190FDBBE4EE2F79E5753BBB368255EE5B19C05A4ED9F1B2C72FF1E9B9CB0348205087BEFA501E7793770FAF0606E9C901836A9BC8AFA00D7DB94EE29EB191D5CF3FC3E8DA95A0F9F4A2A7964289C3129B512BD890DE8700A9205420F28A8965B6C67BE28BA7FE278E5FCD16F0F22CF2B2EACBB9"},
    {:sha512, "562B5EF3D5CEC882A2F54F8169612DBA2B033325CE5ED924024E7806C745DE9E7612DBCFCBB95EA3FDB93DE9C6460A866BD412B45EABA5139939FE43D20F9315", "FE27BBC87755AACC37F667F8CA37F8888FC9DC530FE4F8F38E8CD426E01307747EDFF012D96DA707EE96338D1B11FEBA313A865FCA115431DD8632268FF499224CEB69D31732DCD91E0CBD2B92BBD5B6B543A74735705DAAB81A0114B8A8F0BE91D38CD3D8AD328CEFE16C99D63C67C4446CA7D1F708F9A848D1A9B60238F6907420C3D9C5E48F67889CA7A1909C", "99841C3E4A41B53C30267DC056E7E9B8F9994494DFBBA363EA761C38EC2433D3BD10957D8B7C093472E9A3084C923AC5CB3A1DD2C5270259CE6F3FA80C723DD847A829AC409DECBB44395ED20045B694972B4663F2FD658458B9AC7D3ECC65C260D4409110AA481BCEA016E41A07446C86F5250F0F45B32AADDEC97F293993DB"},
    {:sha512, "5F3422F586E6DBAE45DDC87F8D04B0C88152F90FABFC6DFBB0CCD7EDAE37DE528460A7BF16C4C0521355D5F28C88FFEB55986F8B919FEB756693B076C1690D5B", "F84D1361C51C3E50E245848383FCD37B2F7B0FD916010A7FA41BB1F256228302CD0548AE2148FF42774D18C2D6D3E38B36BC4938DA13BAC3E04D66EC17CFB0DF10B1DF1178C2176BA4CC89AA6E19E606403519116EF635E3C9BAAC7471F0C349EADA42537290701492493E03F4D6C332746FE82E79B2652686E9EC500C8CA389", "2BAC5A6BD9DC5EE714606E2262BBD3D3EF73C9D578688321676370FA40F2BD673B741BE63370C25FBE2BB5579E79486658D3E0EB22AAFBFE02FB70A63524F74CCEF6EB709F0B4F9B5C591095FE0889D766814C4343C82013350B4610337B01042A5A5571E6550E83361504444B119E0F62A69547A369FA4848BC7B9E019FE276"},
    {:sha512, "6E989EC9CBF010AD6691A672FF4CA90A00275F9BA4C81CD147CC506E1DBC8BC93B1D96A375E493503C0AC697F7C45E4FADF138242DF7E06E677DE245AFA97780", "95AF10920DC788269E70B8560B73135CF7F6F5B04A502C7BD61CB74F3B8CCD160701224922D865636A860D949AE755B970D3858C0FF37418A2D24B7142378BA11AB352E5C876DA1A076642728B73916B2D24F8024876572363E7036510CEC7F413ED28CEC749ED33BE3ADF56A8BECE597612D478BF84DE85628367946DF887F73DD92D6DE7FAA896D7276D", "61D91F317A902EA0944E11E92E6657A589E17ABC027FCD869FF8B030E8870662F8A9E91ED3239CECFA42C0343D66CBEBD1C2B771A25DF7BAEA5CAFAD038424C97AFB720E644E7D1BF5B829944EA2CEC69766E68E4E580976DE071C2274C0C5EB0E5421C9D51BBA76AC39B3D009204680035771D9AD79EB02A3805D58E243CF0E"},
    {:sha512, "8C385547A8EBA518E777C3593C5B7CE0BD7C859AF6D67B6238D20A58B8D0D74D80D18AB358EF1C1218B928A026AE8C4E3B73BB5BC0914DE905D499C75E6F3D9F", "5860501208A4C922AD7550DBD931A19AC1434750E63D5F34F528A0B5EB1798B37C0338EEB6D293BFE2B9E306ABC4CD6382B3E6A94008758F0D5E7BA981FCF0970AAA507D8EC456B3518C07BD18C4F37D8F7DB8A7E82AC776C5F86B9D58620781C8FF9FA5D79F9965C397C5E869599C50B048C53325CADE4FE39E7879B67063D780AA2D4FDB8EE53FFF82246FE7AA", "C35B26BD02499CDB6B06BFA4B18979F0A472BA7C559DBD277BF78C611590C6E051F2A094ADB22ADE5C44D4FDEB1330C924D1F9A3330C55AC07035735FBB7C877B64527844F72EE7EB58817074F61DFF8DFC1CA56ACE9E782E06855AF2F350699B9FBC37532B47023407992AB24980EE79DE8337D0959FB11CECF8EB8F83108AF"},
    {:sha512, "8D9725605AEA94C3EF125B307F7ACD5A906D10B4908FCD21F678937CC4605B0800AF50480EF6FF1439CCA60CD1986F04A1DDEA0ABED6C8DCB9B485A923288C03", "C4E631ADCCA6A4735C905C369C7CD44D132200B362F29A0A3240B7E06BA49D32A6A1D82EE6848B3D828F05416657941B7C6B9E716436EDAE6B274B4ABB0F4F4BCFCA760C2A21753D49EFCE2BD683A2411E46C6CFC59D190BB811145664AEA2C026A832CD02450B7A97F6E07B52C7A5C7E3FAA156EDEFC3290248398CCE", "E8AB6A06DBCD52A245152D3851CEAC0551D5C3780DA0A44F5A7FEDFEEF222050755C5550DD262B6AF6E704CE3FF37215FA51EC2781C1C65CDDFD60E195409D5EC40596D56E1190CE14B32CB1864BDE73F909A07459F7E8A8E13AD7F6E895B3DDFE2E975D37956915C7020DA9CFDED866778548293D4BF27C8DBDBB0391294B17"},
    {:sha512, "90093BDCC45DA7338BD2EFE92E30933B14F75582739C747F7572B3270B104F33AF0C939E3C8AE53B2066FC8C97CCF38785CD2EC3D79E6946499D36121E44A3E7", "E9E4480D1C4A621E0C4E1505992556347A7AB34FD2B289910474766CC969116F8040D96DC5F66CDC4454FA7BCFB9F838AF19195038467AB8A16E1CBC12E598E6FD250E21B2145F1E2E859CF73400BE12A0C69749F7100847429875351D5A76970B9CCF700C2CA3AD72E9E4C0F0840E8CF488158136989B0891F867211350134A", "B82EEFB2081BD14DAB0E9E345248A34ADE73F3291886B91EA3E8CC742FD884F6EE0CCDAF4C9879F4DB12DBA58CF491AF2541A1D5EF6CC8B1AF750EF5D8559EF7FF9CD56D8F599974BE3AECD8C0F4C08F3AE50D86F9F822A1E4CA39FD2F0B4D78D22630733A24D8D63ECDF9555411DAF205A761C39EF46FF6292E74129BC13A7F"},
    {:sha512, "9210B074BB645C3A36CE46F9921DE1D6CD8C9F37829C251D1D999C193DC30467D44C830084914CF19F4BA761A0E774C103F092B51EA25BEB1B8277E99FDE26A3", "AD8DB0F165D0ED6E9495E6E53EA1E0DEE4437CC156DB2E83C999F084298738B8B1CA2706B82503EDCEBEE76D0725B92597925DB99F6E2876471598390DDB428C5D4D0B1361B99B271AF00FC0B04AEE9806EB5F8D924599476CDE9A1CA4531C30D99EC5E107949E62A1B1C6A5E018687F5AD6EA07D667673F5F7B60F697", "B6D8212D828DFAF27A03B79F0CC73ECD76EBEEB521058C4F317A80BB5AFD41DFF5520E525358DF7851469BEF2C358B2A97DF0F5C0BA68F985FD8B5369831D97802A1BD6E80507B1620E0BBC8F2F229D11BEB275F25F8BE9D994FDB1ED0B8B87F064C9848B07DB7140F5781F20606020A29979E84160302A508695A3BA99BC43C"},
    {:sha512, "9F5C4FD863F070B85D29B933B1379E7023335B74AAC37186315E959473BF2B3C0F1F893E1FEACE27DFFE35BE6C607A22B02D695E41948B3B6B2BBF58AE7AE84B", "5D307655CF8F7C1B3B573BD75E2374942EE3E56B6B2578EC7793BBC067BC908D5A17261A094427B4A09633D0CDCF8EF1162A15CC6F9F77AA0C62A10F74AD7A99D7BFD12AA125934A4F3842C681E7A29D51B6B61DE407EA4A3E98927F5B4E93587B3160CEBDB729A4EF454F03A5F31A618890AEA7F1E63B92B73E755945274491", "F91BC92F97C28B011E7BB1DCE84CF9154942094AB908B49635B87906E2F14C51F42A9AC3CE46877B6A687AD6FC08DB2BD2471BB97F7FF5DD381FF4897EB636F1FE4D6F87B5FA302A57B26A9AF25F2E30CE32B6CC993BA90EC0379BC920A9D3B4DE2C526393071176AD0289111278788C06AEE36B4E63579095A875AF10F2AE03"},
    {:sha512, "BB714844B6BE93CCEC0ACB8780996B2A4778C42A8A76A49EFF87CED3A258815D76685DCE4C8AE37C244229F17E0503DE089A043368CD300D13F842F28C111FBB", "BCEAF34D50C1F202539233630B16DD048EA23F093C9F713B8D3A385B0D5C2BB6A4DD14F91BF59947DCF31C89F931DF0570476C33AE7F34CB51897623327062B8A3CD7F0AF53B4AAE3E0A209E58385DD32D9CC6163265241332C332AF4DE4B99B4022FA29", "F3BFA5C1F1055281A35B48F86FA3AE454C03EAC56FF064CF268B8DA20431219B3E4DA9AC55714309F5A6A5241E0060DC817562F12DEEBFBC6A9FB11DE594DDB40E8DD754BF0CE9B41EAC1068C4B448101FEC09D014B01200E94265246365931E2B2739A276FECBEBE51690ACAAEAEE4AED12E8486E5BE5036B1DB39FC4C9CB41"},
    {:sha512, "BE73D57AB3A7C5BB305451922FA9B11D0AE938BEC886FAC5645A8B72DE93770D96465291DA2BDD5D11692F2CBFAE69ADB36AE714F1E5CF43B9D2841DDEBA4CA6", "5C8589B3845970145E12B34713455EB6B5CEB132242024E42FD9A886FC9A30D3AA15703B3467E4DC99A915AE3AC118FD837E571DCDE5945983C52A2C849296B4C96F3763488D52F818B459ADD51F6DB2468D21DB3D958196BF3A531F65BF9CF702BD66928672C14F235C08AEAE0665BE472397D43CD9F3822B5FA9C767", "7F2544A478961DD012AC705E12E74587E2DF6B2EE1406A0BFE13B908853F31EB384FC236A275654BA8CF51D461EA726228851754EF97EBFBD69326FCFCEA04F594D177633C4618C38B4D64F7E98025ECA4C62E7A40634B8B0E317880002C51D0BB34CAF2EE0F207EE2AE108F53B1466B7F2D18667CAC7403CE75175D390E00C5"},
    {:sha512, "C0D6E13C5746369D49BEF107CFC9A465627691320B8203233359E6A49659025AC96A6DB6C4D460224F6AA1CB7A6B8DF311E066F6109BD466CD9AEE3058DBC5F0", "662CA8F53B97EDD9BBD43B1F9E4EA49F2AC14417FAEE257AFF93608BC49A85ABF6913DEF235A2E76C2241FFA749A5DA489595D25C6A8A2026563E12F5E3964E0E518AC9C34E45A938A6F503174A613F34B08737AFE5D6FDE11A45344E64D23B33CA83C23", "0C057A2B56CB7E651C6339E4C91A1A72D51AF2A646DE9DFD77E9E42C18B8A2B576F526B9FCEDD90DFA442090A6E784BB614311793BB5FB39B8418842D586294746F1EA3C02320D6801ECF2BA44B13B60172D2D9693A158BC66947AACD7C5A14A0463905D6E80649DB8C4770CAC5E858A7F400DA4568CFAAE08498311265B50E5"},
    {:sha512, "C1437541647FB134322FE4809DE516FF2A9982C16132077DAC91E0E06F14CFA943FC8539A22C91FAA3FA8FE623DAFC954EBEE5C17136281E7F8A3038F58BD80A", "FFE01CBD0EF36A85E32ADF18931C4761709FB382228B27BBF9C1938D816C041F57871CE03CA0C06E68DB10B720399C5E8B1AD460C201C1F72698F3BEF6F4BB1621199AC958C1F8EE6859190DC74D4E836C856827E430722DA3C0A04B9835821B049F7DC18BDE7CCD8CADE363AEDFC599BBE75620B29EA3271741807C8EB9C2F4", "A32D2FBA17F4B0F08A9EE7EDEAB34B1B8F7B12AD6E65FE248FA97A18C12DE5358CA62E8467FFA1EB2BFE00F8C825D6DA36D608B0AFBBAD071C651F9DCD33526B6C7665E334D277775EE8BC5ADC31D08A4A2D4B0E22BE957C2FCEFCBF443803172DE6FD61E637DB990BA3439D90A1E234B2C8024E2D355F8EB02E36058E04A041"},
    {:sha512, "CB700E68AEC9448B67AB8E15D491AA070242B4430D6C70DB6B736AD66756065F417C0B201395E203C57BD7809272CE34D4DFE1972B7C5277A28D71C7F52C32FD", "9CB3288F3B04F0442F2CA8CDC41B0F39DDF93F898868E312D509A422E941E4E64E3DAF8B8D33EEA4FFEBDECCE07FC18CA55FD47F8F9780B38155D4530FA53383D7804A8C14054539700643811AC607651901F01CE02D2B6E2200275EE732490BE084E2D8F7015ECB2B84BE339B7A488EE0E97CA9A0B24B096013848A9A6F8F4610525DB85FB09F22D76D36", "96A83010F9D4F0405826E8CC941190E07C33D933362DB680E1B1DB3A78DDC47CF9C7FA3FC75992CF4D5FF680E5DEE89CF8A7C3A1662D04A928940A2A340A1ADFA05AA6060BBECFCC39F52806FD96BD215CA4545CEF62F2348969A1201AF7717FD38ABDCF8BAEAF1F621306C7A4E21756F05112CC9976870A4C582986F34CD143"},
    {:sha512, "D032BFB5A538197385EB70673CF8F93E31FDF9C22C0E90008A454BA4D69BDC2232475A41723C8A5E3B29C6DE929A7A1E87B64BEECDA29683D0D925F00CE23B35", "1CE7E20ABBDCD1154D4B536714FF534A01B8E88C78DA34D653638C39291FD80AD01F3DF02067FA3BFAE7907789AD2641C8582B5A45D03DFA24344A676614F5C56CE13B30B6A15608F1E7E18C31033EAB7B76351686A9DD9AC2DEC0AD9A663A47F61422F3", "46AE8403EBB4C8723652B9848FDAAA537A50E3191BD94442F9702BC602DB98B5CFDD8F142AAEBEE7CDA8608F6D436156F743C3491A30404605073155722FAE3BE3AEF74D2B9D128331D9B6CDF1FC68AAC38CE4F6E072BE0322AD49EC0B47B82609888358F86B0D6DE94E83E722ED077666910EC9768506A4D7CA3D33D60BFE9E"},
    {:sha512, "D725750A042DE65607AF5EF523E3C86D08BE52427B7036AD514B9596C901E96D76B5E58F68907044282E695B3B875C09AD49ECD9950FE312A59DAD691471C572", "FE4C83E8496A69B7A251228396A5D2B4849EDCEE0AB1F8DABD6D872A1DA324D7C8C97CADEDA05F0A041517E3BC65F807358538A870C1011704A3C5CF1216D2B57ACB269E4FDC841289B0C750FA1E779184D59A9188FBCC4CA11492059326EC8D7E1A29C25866FF5699E9DBD2381676DAD755A9B23BA68201FE8897D588199AE83B7E2E22EE85F95E9D89FB715E97", "C24FAB7F7998C69063C2D1103E60A6C4CB03206ADD01D09FAF75F1007A879E9047EE435A02B35257D1373791A4778D890C8F92D6507DD810BE283EEC3FA11FA82EA8C9AA6A723164AAA9E57A11B54127033AE6DD36E1682B0C5C47E420A4217E1E8525B8D95DCB7F9721C213AFA02A66570C04C5B7B6E7B94219F430451A0CD8"},
    {:sha512, "D78285AB97DFFED5F16D00A7F277EEE9E9BBBC5EB14FAB10C189739965FB3DD1C196FBE3B01363260BF688955278884812286DCF81C25F1EB17CD2503FFC7ACC", "59AA9D7F583F6AB90B472935AA6DEA95E2FBE402CBF70C6E1992E61C96C49B63D0304DAF0E4DA7C889C7B857D92301A6AEA3CCA7C069C03809DEB3A53155BF6E4AEC984BBDB31C6E84112C089A63BB0EB0E5243D22D6C15C29D7B9C1529519162FA7275D4CBAF33264EB2E50D5743F57528B94CDD8873662E345A178E1CAD2E2E729A1ECA3A7519C921E66", "B9A8865C3A6BA8F2C13F35730B39FC3C92405C06BB6E116851B84D9D32D20A88484D9FF5BB03922265B4AE7E87F155B0BA3917DB28638321FB3B3C661670505603AEC6A92D0776A550971EE52D68B15A8293F28F39A84231E050B6CE59316DDDD31221FFF940FB846830AC316765B940D29416A95807F7A0E73FE35F63DD0A25"},
    {:sha512, "D8BF5FF4392938534A7962C64985F163CE7C95E6C05F93CF704106F9BDA7C9AE963F5EA87F73626F67ED3146E8611CA62EF2EEB4F9A13847DC6E7FFBE3D851A4", "3699D9CD078A20EC0C96EB01AA60DF6CD5DCB554260EEA8E2E15B7C00B6943C638611854AAF8D3DD18D020B49A77E67275EABF973557AB74FD2705481C3CB6A9E077A825AF7E7E2A53BC822396A9DEE40F4B10483BFD9818D06FF32F4DEECDDCD6E57388", "9186EAA3B8E785DD2A747297BDBDD4F5532A47B7008C21686FF7F8D881D464CD383205F6D45DC8203BB267AC9EB12F415A5406BE1C9FAC73497941909DBA08DD12856AAC03D83E0D916147404694FE70F8FA929EF0CC2EDB4CC07ABAA2236405E62820AF8E806D0AF32A1B3AFB8DCAEAF5C4F43DC4392E074075AA3ED93601AB"},
    {:sha512, "E913FCCC25F84A1390EF0B0F86050FE9E61146C1B4EF0B4B60D187BAA36B61458BBDA925B96E99CF8A4330291690417FE194CB9BC2B6232D43E046D13F038ED3", "0F67CACEEDF8CCE39A7223D32AE1B6BADAE2C2AB01BF75F543DBB8A408514C4B2CD81801F9EAC1AA52257C7830F120B1536380B23161F734330744CE204A98BBD9DBEEDE484E9B03937C26689526597C8EDB98E6191B72C95FBC76468B8D48437E3AF46BC36F8176C540CAAB3FC989A3F511B54FA2350E3D31C2F6162F", "3173A712ED715B321A849279BE6BA237FC90DEC0E48B0E1290E81CB86C2A10EED50F3E05E616BE098E3F1DA2E6125238C2E2F45A8753AA613C1AE250E304C6FF093A6B799CC34CA2FD4AF81D5622076C2E8752593A27649576E12BA075CCF3E8F57B9635B77FEC448E2E89B2B5A3A81D65066285A70E24F868C35F6ECB8981F2"},
  ]

  test "known HMACs are correctly calculated" do
    @golden_nist_test_vectors |> Enum.map(fn {algo, hmac, key, data} ->
      assert Hmac.generate(algo, key |> Base.decode16!, data |> Base.decode16!) |> Base.encode16 == hmac
    end)
  end

  test "HMAC calculation works with atoms for hasher" do
    assert Hmac.generate(:sha256, "key", "test") == Hmac.generate(Cryptex.Hasher.Algorithm.Sha256, "key", "test")
  end

  test "HMAC calculation works with enumerables" do
    assert Hmac.generate(:sha256, "key", ["te", "st"]) == Hmac.generate(:sha256, "key", "test")
  end

  test "HMAC calculation with data is equivalen to new followed by calculation" do
    assert Hmac.new(:sha256) |> Hmac.generate("key", "test") == Hmac.generate(:sha256, "key", "test")
  end

  test "HMAC hasher is the same as the algorithm passed to it" do
    assert Hmac.new(:sha256) |> Hmac.hasher == Hasher.new(:sha256)
  end

  test "HMAC digest size is the same as the underlying hash algorithm's digest size" do
    assert Hmac.new(:sha256) |> Hmac.digest_size == Hasher.new(:sha256) |> Hasher.digest_size
  end

end
